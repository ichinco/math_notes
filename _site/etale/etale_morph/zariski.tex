\chapter{Zariski's ``Main Theorem''}
\label{sect_zariski}

\renewcommand{\O}{\mathcal{O}}

To summarize briefly the purpose of this chapter, we give a short 
overview of the few important morphism types in algebraic 
geometry: finite-type, finite, proper, flat, \'etale. The central 
result(s) that relates many of these is Zariski's ``Main Theorem'' 
which has as many disguises as there are mathematicians who read 
it. We tackle three of its forms. To conclude this chapter, we 
give an application of the ``Main Theorem'' to the structure 
theorem of \'etale morphism.

Central to this section are two main ideas: flatness, and 
separable field extensions. Both topics are too central to this
chapter to dispense, but too lengthy to discuss without cluttering
the mental space of the reader. To have the best of both worlds, 
these topics, unfortunately, are delegated to the chapter's 
appendix, with many of the proofs curtailed into a 
pseudo-exercises. No doubt, the answers are readily available on 
the internet (free), or in one of the standard texts on this 
subject (not so free). The avid reader who seeks a post-doctoral 
position is highly encouraged to try for weeks on end to fill in 
the gaps of many of the proofs without consulting too many 
sources. After all, one of the ways to remember the work of others 
is to do the work yourself (or write textbooks).

We make no assumption about schemes (integrality, separatedness, 
projective, etc) unless explicitly stated. 

\section{Finite morphisms}

For the following definitions, let $\phi: X \to Y$ be a morphism of 
schemes.

\begin{defn}
We say that $\phi$ is \DEF{morphism!quasi-compact}{quasi-compact}
if the inverse image of any affine open subset $V$ of $Y$ is
quasi-compact. 

If in addition, for any open subset $U$ of $\phi^{-1}(V)$, the 
canonical homomorphism $\O_Y(V) \to \O_X(U)$ makes $\O_X(U)$ into 
a finitely generated $\O_Y(V)$-algebra, then we say that $\phi$ is 
\DEF{morphism!finite-type}{finite-type}.
\end{defn}

The reader may be careful to note that the above definition
deviates from the one given in \cite{Hart} II.3, say. In fact,
the two definitions are the same.

\begin{prop}
Let $\phi: X \to Y$ be a morphism of schemes. Then $\phi$ is a 
finite-type scheme morphism if and only if there exists an open 
cover $\{V_i : V_i = \Spec B_i \}$ of $Y$ such that for each $i$, 
$\phi^{-1}(V_i)$ emits a finite cover $\{U_{ij} : U_{ij} = \Spec 
A_{ij}\}$ by affine schemes such that $A_{ij}$ is a finitely 
generated $B_i$-algebra.
\end{prop}
\begin{proof}
\pfitem{$\Rightarrow$}: Fix any covering of $\{V_i : V_i = \Spec 
B_i\}$, and note that $\phi^{-1}(B_i)$ emits a covering by affine
subschemes. Since $\phi^{-1}(B_i)$ is quasi-compact, it follows that
such a covering has a finite subcover. Let $\{U_{ij} : U_{ij} = 
\Spec A_{ij}\}$ be such a finite subcover. Note that $\O_X(U_{ij}) 
= A_{ij}$ is a finitely generated algebra over $\O_Y(V_i) = B_i$.
The ``only if'' direction is established.

\pfitem{$\Leftarrow$} (\cite{Liu} 3.2.2): assume that $\{V_i :
V_i = \Spec B_i\}$ is a cover of $Y$ satisfying the hypothesis
of the proposition.

To see that $\phi$ is quasi-compact, let $V$ be any affine open 
subscheme of $Y$. Then $V \cap V_i$ is open in $V_i$ and has a
covering by principle open subset.\footnote{\DEF{principle open 
subset}{Principle open subsets} of an affine scheme $\Spec B$ are 
subset of the form $V = \Spec B_f$ for some $f \in B$} Since 
affine schemes are quasi-compact, it follows that the collection 
$\{V_{ij}\}$ is finite.

Furthermore, if we let $\{U_{ik}\}$ be the finite affine cover of 
$\phi^{-1}(V_i)$, since $V_{ij}$ is a principle open subset of 
$V_i$, we see that $\phi^{-1}(V_{ij}) \cap U_{ik}$ is a subscheme 
of $U_{ik}$ which is also principle open, and in particular, 
affine.  It follows that $\phi^{-1}(V)$ can also be covered by 
finitely many affine open subschemes. To conclude that 
$\phi^{-1}(V)$ is quasi-compact, we note that finite union of 
quasi-compact subset is quasi-compact.\footnote{The argument here 
is entirely topological. Let $\DSt W = \cup_1^n W_i$, with $W_i$ 
quasi-compact. Indeed, fix any (potentially infinite) cover 
$\{W'_i\}$ of $W$. By intersecting elements of the cover with each 
$W_i$, we have a refinement of the cover where only finitely many 
elements in the cover intersect each quasi-compact piece.}

Next, fix $U \in f^{-1}(V)$. We want to show that $\O_X(U)$ is a
finitely generated $\O_Y(V)$-algebra. We make the following 
observations:
\begin{enumerate}
\item for algebra $B$, $f \in B$, we have $B_f \simeq B[x]/(xf - 
1)$, and it follows that $B_f$ is finitely generated over $B$. 
Therefore, $\O_Y(V_{ij})$ is finitely generated over $\O_Y(V)$
(since $V_{ij}$ is a principle open set in $V$). Similarly,
$\O_X(U_{ij})$

\item if $B$ is finitely generated over $A$, and $A'$ is an 
$A$-algebra, then $B \otimes_A A'$ is finitely generated over
$A'$ with the same generating set. Writing $U_{ijk}$ for $U_{ik} 
\cap f^{-1}(V_{ij})$, it follows that $\O_X(U_{ijk}) = \O_X(U_{ik})
\otimes_{\O_Y(V_i)} \O_Y(V_{ij})$ is finitely generated over
$\O_Y(V_{ij}$. From the previous point, we have that
$\O_X(U_{ijk})$ is finitely generated over $\O_Y(V)$.

\item for an arbitrary affine subscheme $W = \Spec R$ of $X$, we 
have that $U \cap W$ can be covered by open subsets $\{W_i\}$ 
principle to both $U$ and $W$. In the case where $R$ is a finitely
generated $\O_Y(V)$-algebra, then each $\O_X(W_i)$, being 
localization of $R$, is also finitely generated. 

Applying the above to the affine subschemes $U_{ijk}$ and noting
that $U$ is quasi-compact, we have that there exists a finite
affine cover $\{W_i\}$ such that for each $i$, $\O_Y(W_i)$ is a
finitely generated $\O_Y(V)$-algebra.
\end{enumerate}

At the conclusion of item (3) above, we have $V = \Spec S$,
$U = \Spec T$, and there exists a finite subset $\{f_1,
\cdots, f_n\}$ of elements of $T$ such that $T_{f_i}$ is a
finitely generated $S$-algebra. Fix $T_i = T_{f_i}$. To say
that each $T_i$ is a finitely generated $S$-algebra is to say that
there exists $t_{i1},\dots,t_{im} \in T_i$ such that any element 
of $T_i$ can be written as a polynomial with coefficients in $A$ 
of those elements. 

Moreover, multiplying the numerator and denominator by powers of 
$f_i$ if necessary, we may suppose $t_{ik} = t_{ik}'/f_i^{N_i}$ for 
some $t_{ik}' \in T$ and $N_i$ a sufficiently large integer. Let
$T'$ be the $S$-algebra generated by $\{t'_{ik}, f_i\}$ for all 
$i$ and $k$. Then $T'$ is trivially a subalgebra of $T$, and it is 
easy to see that $T'_{f_i} = T_{f_i}$.

Using the fact $W_i = \Spec T_i$ cover $U = \Spec T$, we have that
\[
\sum_{i = 1}^n s_if_i = 1
\]
for some $s_i \in T$. We claim that $T$ is the $S$-algebra 
generated by $s_i$ over $T'$. To see this, let $T'' = T'[s_1, 
\dots,s_n]$ and notice that for each prime ideal $\ideal{p}$ of 
$T$, $\ideal{p} \cap T''$ is again prime. Furthermore, since 
each $s_i \in T'[s_j]$, there exists some $f_i \notin \ideal{p}$, 
whence $T''_{\ideal{p}}$ is a localization of $T'[s_j]_{f_i}$. 
But, $T_{f_i} = T''_{f_i}$. Hence $T_{\ideal{p}} = T''_{\ideal{p}}$,
which holds for every $\ideal{p} \in \Spec T$. Since 
\[
T = \bigcap_{\ideal{p} \in \Spec T} T_{\ideal{p}},
\] 
it follows that $T = T''$ as desired, and $T$ is finitely 
generated as a $S$-algebra.
\end{proof}

\begin{prop}[\cite{Mum} II.7.1]
\label{prop:fin_type_is_local_on_base}
Let $\phi: X \to Y$ be a morphism. To prove that $\phi$ is of 
finite type, it suffices to check the defining property for the 
open affine sets $V_i \subset Y$ of a given covering $\{V_i\}$ of 
$Y$.
\end{prop}

\begin{rmk}
The result in Prop \ref{prop:fin_type_is_local_on_base} shows
that being finite type as a property of scheme morphism is local
on the base. 

More specifically, let $\property{P}$ denote some property of a 
morphism between schemes. We say that $\property{P}$ is 
\DEF{local on the base}{local on the base} if $\property{P}$ is 
true of $\phi : X \to Y$ if and only if there exists some affine 
cover $\{V_i\}$ of $Y$ such that $\phi|_{\phi^{-1}(U_i)}: 
\phi^{-1}(U_i) \to U_i$ for all $U_i$ in the cover (see \cite{Liu}
Def. III.1.21). 

Properties that are local on the base allow for one to reduce
the proof to the case where the target is affine. This is often
a tremendously powerful technique and will be used often in the
subsequent results.
\end{rmk}

Before we prove Prop. \ref{prop:fin_type_is_local_on_base}, let's
prove a weaker statement.

\begin{defn}
Recall that $\phi$ is \DEF{locally of finite type}{locally of 
finite type} if for every open affine $V = \Spec B$ of $Y$, 
and open affine $U \subset f^{-1}(V)$, $U = \Spec A$, $A$ is a
finitely generated $B$-algebra.
\end{defn}

\begin{prop}[\cite{Hart} Exercise II.3.1]
The property of being locally of finite type is local on the base.

That is (still weaker), $\phi: X \to Y$ is of finite type if and 
only if there exists an affine cover $\{V_i : V_i = \Spec B_i\}$ 
of $Y$ such there exists an open cover $\{U_{ij} : U_{ij} = \Spec 
A_{ij}\}$ such that $A_{ij}$ is a finitely generated 
$B_i$-algebra.
\end{prop}
\begin{proof}[Sketch of proof]
The arguments are similar to those of Prop 
\ref{prop:fin_type_is_local_on_base}; thus it is of some interest
for the reader to work out the arguments with the following guide.

One direction is clear: $\phi$ locally finite implies that 
$\phi|_{\phi^{-1}(V_i)}$ is locally finite for any cover $\{V_i\}$,
\emph{a fortieri} a specific affine cover.

For the converse, assume that there exists an open affine cover 
$\{V_i\}$ that satisfy the condition given in the proposition.
Show that for any affine open $U = \Spec A$ of $\phi^{-1}(V_i)$
$A$ is finitely generated over $B_i$ by considering the principle
open subsets of $U \cap U_{ij}$.

Fix some $V \in Y$. Notice that each $V \cap V_i$ is covered by
affine open subsets $V_{ij} = \Spec B_{ij}$ principle to both $V$ 
and $V_i$. By the above, for any affine subset $U = \Spec A$ of 
$\phi^{-1}(V_{ij})$, $A$ is again finitely generated over $B_{ij}$.
The proposition now follows.
\end{proof}

\begin{proof}[Proof of Prop. \ref{prop:fin_type_is_local_on_base}]
By definition, if $\phi$ is finite type if and only if $\phi$ is 
quasi-compact and locally of finite. Being locally of finite type
is local on the base. It is also straightforward to see that being 
quasi-compact is local on the base. It follows that being finite
type is local on the base.
\end{proof}

Now to reap the power of being \emph{local on the base} (see 
(1) and (3) below),

\begin{cor}[\cite{Liu} Prop. 2.4]
\begin{enumerate}
\item closed immersions are finite type morphisms. 

\item open immersions into locally Noetherian schemes are finite 
type morphisms.\footnote{Recall that a \DEF{locally 
Noetherian}{locally Noetherian} scheme is one that can be covered 
by affine schemes $\{\Spec A_i\}$ where each $A_i$ is a Noetherian 
ring. A scheme $X$ is locally Noetherian if and only if for every 
affine subscheme $\Spec B$ of $X$, $B$ is Noetherian. (See 
Appendix A )}

\item composition of finite type morphism is a finite type 
morphism.

\item finite type morphism are stable under base change.\footnote{
A property $\property{P}$ of a morphism between schemes is said to 
be \DEF{stable under base change}{stable under base change} if 
$\phi: X \to Y$ satisfies $\property{P}$ implies that for any $Z 
\to Y$, the induced fibre product map $X \times_Y Z \to Z$ also 
satisfies $\property{P}$. This property is sometimes quantified as 
follows.

We say that $\property{P}$ is \emph{stable under base change by 
$\property{S}$-schemes} if for all schemes $Z$ that satisfies 
$\property{S}$, $\phi : X \to Y$ satisfies $\property{P}$ implies 
that $Z \times_Y X \to Z$ satisfies $\property{P}$.}

\item if $X \to Y$ and $Z \to Y$ are both morphisms of finite
type, then so is $X \times_Y Z \to Y$.

\item if $\phi \comp \psi$ is of finite type, and $\phi$ is of
finite type. If $\psi$ is quasi-compact, then $\psi$ is also
of finite type.
\end{enumerate}
\end{cor}

\begin{proof}
\begin{enumerate}
\item Since being a finite type morphism is local on the base,
we may assume that $Y$ is affine. Say $Y = \Spec B$. In this case, 
$X$ is also affine (see \cite{Hart} II.3.11b, or the Appendix for 
a proof) of the form $X = \Spec B/I$, and the inverse image of any 
open affine subscheme of $Y$ is also affine. In this case, it 
trivially satisfies the condition for quasi-compact and locally of 
finite type. It follows that closed immersions are finite type 
morphisms.

\item For open immersions, if $V$

\end{enumerate}
\end{proof}

\begin{defn}
We say that $\phi$ is \DEF{morphism!affine}{affine} if for every 
affine open subset $V$ of $Y$, $U = \phi^{-1}(V)$ is also affine.

We say that $\phi$ is \DEF{morphism!finite}{finite} if 
$\O_X(U)$ is a finite $\O_Y(V)$-algebra. That is, $\O_X(U)$ is
a finite $\O_Y(V)$ module.
\end{defn}

There is again some difference between the above definition of
finite morphisms and the way finite morphisms are defined in 
\cite{Hart} II.3. Once again, the two definitions are the same, 
and we defer the proof of this particular result to later in the 
text.

\begin{prop}[\cite{Mum} II.8.3]
The property of a morphism being finite is local in the target.
That is, to show that $\phi: X \to Y$ is finite, it suffices to
show that there exists some affine cover $\{V_i\}$ of $Y$ for 
which $U = \phi^{-1}(V')$ is affine for any affine subscheme $V'$ 
of $V_i$ and that $\O_X(U)$ is a finite $\O_Y(V')$-algebra.
\end{prop}
\begin{proof}

\end{proof}

One example of a 

\section{Flat morphisms}

Some text.

\section{\'Etale Morphism}

Yet some more text.
